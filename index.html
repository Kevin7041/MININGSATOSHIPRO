<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Satoshi Overdrive</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* --- ESTILOS GENERALES --- */
        :root {
            --bg-dark: #05000a;
            --card-bg: #130026;
            --primary: #8b5cf6;
            --accent: #d946ef;
        }
        body {
            background-color: var(--bg-dark);
            color: white;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 0;
            overflow: hidden;
            -webkit-tap-highlight-color: transparent;
        }
        .main-container {
            height: 100vh;
            overflow-y: auto;
            padding: 20px 20px 120px 20px;
            box-sizing: border-box;
            background-image: 
                linear-gradient(rgba(139,92,246,0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(139,92,246,0.03) 1px, transparent 1px);
            background-size: 40px 40px;
        }

        /* --- UTILIDADES --- */
        .hidden { display: none !important; }
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .justify-center { justify-content: center; }
        .gap-2 { gap: 8px; }
        .w-full { width: 100%; }
        .text-center { text-align: center; }

        /* --- COMPONENTES --- */
        .card {
            background-color: rgba(19, 0, 38, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255,255,255,0.05);
            border-radius: 2rem;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 0 20px rgba(0,0,0,0.2);
        }

        .btn {
            background: linear-gradient(to right, #7c3aed, #c026d3, #db2777);
            border: none;
            color: white;
            padding: 16px;
            border-radius: 16px;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 1px;
            width: 100%;
            cursor: pointer;
            box-shadow: 0 0 20px rgba(139,92,246,0.5);
            transition: transform 0.1s;
        }
        .btn:active { transform: scale(0.95); }

        /* --- VISTA HOME --- */
        .rank-badge {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 6px 16px;
            border-radius: 50px;
            background: rgba(0,0,0,0.4);
            border: 1px solid #4ade80;
            color: #4ade80;
            font-size: 10px;
            font-weight: 900;
            text-transform: uppercase;
            margin-bottom: 20px;
        }

        .score-display {
            font-size: 3.5rem;
            font-weight: 900;
            margin: 10px 0;
            text-shadow: 0 0 20px rgba(255,255,255,0.3);
        }

        /* --- CLICKER --- */
        .clicker-container {
            position: relative;
            width: 280px;
            height: 280px;
            margin: 20px auto;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .clicker-btn {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: radial-gradient(circle at center, #4c1d95, #0a0014);
            border: 2px solid rgba(139,92,246,0.5);
            box-shadow: 0 0 50px rgba(139,92,246,0.3);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 60px;
            cursor: pointer;
            z-index: 10;
            position: relative;
            transition: transform 0.1s;
        }
        .clicker-btn:active { transform: scale(0.95); }
        
        .floating-text {
            position: absolute;
            color: white;
            font-weight: 900;
            font-size: 24px;
            pointer-events: none;
            animation: floatUp 0.8s ease-out forwards;
            z-index: 20;
            text-shadow: 0 0 10px rgba(250,204,21,0.8);
        }

        @keyframes floatUp {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            100% { transform: translateY(-100px) scale(1.5); opacity: 0; }
        }

        /* --- BOTTOM NAVIGATION --- */
        .nav-dock {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 350px;
            background: rgba(15, 5, 24, 0.9);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(139,92,246,0.2);
            border-radius: 40px;
            display: flex;
            justify-content: space-around;
            padding: 10px;
            z-index: 100;
            box-shadow: 0 10px 40px rgba(0,0,0,0.8);
        }
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: none;
            border: none;
            color: #64748b;
            padding: 10px;
            border-radius: 15px;
            transition: all 0.3s;
        }
        .nav-item.active {
            background: #2d1245;
            color: #e879f9;
        }
        .nav-item i { margin-bottom: 2px; }
        .nav-item span { font-size: 8px; font-weight: 900; text-transform: uppercase; }

        /* --- MINING / UPGRADES --- */
        .upgrade-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #130026;
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 10px;
            border: 1px solid rgba(139,92,246,0.1);
        }
    </style>
</head>
<body>

    <div class="main-container" id="app-content">
        <div id="view-home">
            <div class="text-center" style="margin-top: 20px;">
                <h1 style="font-style: italic; font-weight: 900; margin: 0; font-size: 2rem;">SATOSHI <span style="color: #facc15;">OVERDRIVE</span></h1>
            </div>

            <div class="flex justify-center">
                <div class="rank-badge">
                    <i data-lucide="zap" width="14"></i>
                    <span id="rank-name">NOVATO</span>
                </div>
            </div>

            <div class="card" style="border-color: rgba(139,92,246,0.2);">
                <div class="flex justify-between" style="margin-bottom: 10px;">
                    <span style="font-size: 10px; font-weight: 900; color: #cbd5e1; text-transform: uppercase;">Auto-Collector</span>
                    <span style="font-size: 9px; background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 4px;">0.05 SATS/S</span>
                </div>
                <div class="flex justify-between items-end">
                    <span id="auto-balance" style="font-size: 2rem; font-weight: 900; font-family: monospace;">0.00</span>
                    <span style="font-size: 9px; color: #94a3b8; font-weight: 900;">MAX 1000</span>
                </div>
                <div style="width: 100%; height: 6px; background: rgba(0,0,0,0.4); border-radius: 10px; margin: 10px 0; overflow: hidden;">
                    <div id="storage-bar" style="width: 0%; height: 100%; background: linear-gradient(to right, #06b6d4, #8b5cf6);"></div>
                </div>
                <button onclick="claimAuto()" class="btn" style="padding: 10px; font-size: 12px; background: rgba(255,255,255,0.1); box-shadow: none;">RECLAMAR</button>
            </div>

            <div class="text-center">
                <div class="score-display" id="score">0</div>
                <div style="font-size: 10px; color: #ddd6fe; letter-spacing: 4px; font-weight: 900; text-transform: uppercase;">Balance Total</div>
            </div>

            <div class="clicker-container">
                <div class="clicker-btn" id="coin-btn">
                    ₿
                </div>
            </div>
            
            <div class="text-center" style="margin-top: -10px;">
                <span style="font-size: 12px; color: #facc15; font-weight: bold;">⚡ <span id="energy">1000</span> / 1000</span>
            </div>
        </div>

        <div id="view-mine" class="hidden">
            <h2 class="text-center" style="font-style: italic; font-weight: 900;">BLACK MARKET</h2>
            <p class="text-center" style="font-size: 10px; color: #a78bfa; letter-spacing: 2px; text-transform: uppercase; margin-bottom: 30px;">Hardware de minería</p>

            <div id="machines-list">
                </div>
        </div>

        <div id="view-wallet" class="hidden">
            <div class="card" style="background: linear-gradient(135deg, #4c1d95, #130026); padding: 30px;">
                <span style="font-size: 10px; letter-spacing: 2px; color: rgba(255,255,255,0.6); font-weight: 900; text-transform: uppercase;">Bóveda Personal</span>
                <h1 style="font-size: 3rem; margin: 10px 0; font-weight: 900;" id="wallet-balance">0</h1>
                <span style="color: #a78bfa; font-weight: 900;">SATS</span>
                <div style="margin-top: 20px; background: rgba(0,0,0,0.3); padding: 10px; border-radius: 10px; display: flex; align-items: center; gap: 10px;">
                    <div style="background: rgba(16,185,129,0.2); width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #34d399; font-weight: bold;">$</div>
                    <div>
                        <div style="font-size: 8px; color: rgba(255,255,255,0.5);">VALOR ESTIMADO (USDT)</div>
                        <div style="font-weight: bold; font-family: monospace;" id="usdt-value">$0.0000</div>
                    </div>
                </div>
            </div>
            
            <button class="btn" onclick="alert('Retiros habilitados pronto.')">RETIRAR FONDOS</button>
        </div>

        <div id="view-friends" class="hidden">
            <h2 class="text-center" style="font-style: italic; font-weight: 900;">CYBER SQUAD</h2>
            <div class="card text-center">
                <div style="font-size: 40px; font-weight: 900; color: white;" id="friends-count">0</div>
                <div style="font-size: 10px; color: #94a3b8; font-weight: 900; text-transform: uppercase;">Amigos Reclutados</div>
                <button class="btn" style="margin-top: 20px;" onclick="copyLink()">COPIAR LINK</button>
            </div>
        </div>

    </div>

    <div class="nav-dock">
        <button class="nav-item active" onclick="switchTab('home', this)">
            <i data-lucide="home" width="20"></i>
            <span>Base</span>
        </button>
        <button class="nav-item" onclick="switchTab('mine', this)">
            <i data-lucide="pickaxe" width="20"></i>
            <span>Rig</span>
        </button>
        <button class="nav-item" onclick="switchTab('wallet', this)">
            <i data-lucide="wallet" width="20"></i>
            <span>Bóveda</span>
        </button>
        <button class="nav-item" onclick="switchTab('friends', this)">
            <i data-lucide="users" width="20"></i>
            <span>Squad</span>
        </button>
    </div>

    <script>
        // --- LÓGICA DEL JUEGO ---
        
        // Inicializar Iconos
        lucide.createIcons();
        const tg = window.Telegram.WebApp;
        tg.expand();

        // Variables de Estado
        let score = 0;
        let energy = 1000;
        let miningRate = 0;
        let autoBalance = 0;
        let friends = 0;
        const MAX_STORAGE = 1000;

        // Elementos DOM
        const scoreEl = document.getElementById('score');
        const walletBalanceEl = document.getElementById('wallet-balance');
        const usdtValueEl = document.getElementById('usdt-value');
        const energyEl = document.getElementById('energy');
        const autoBalanceEl = document.getElementById('auto-balance');
        const storageBar = document.getElementById('storage-bar');
        const coinBtn = document.getElementById('coin-btn');
        const machinesList = document.getElementById('machines-list');
        const friendsCountEl = document.getElementById('friends-count');

        // Configuración de Máquinas
        const machines = [
            { id: 1, name: 'Nano Chip v1', price: 1000, rate: 1 },
            { id: 2, name: 'Cyber Rig PRO', price: 5000, rate: 5 },
            { id: 3, name: 'Fusion Farm X', price: 20000, rate: 25 },
        ];

        // --- FUNCIONES ---

        function formatNumber(num) {
            return Math.floor(num).toLocaleString();
        }

        function updateUI() {
            scoreEl.innerText = formatNumber(score);
            walletBalanceEl.innerText = formatNumber(score);
            energyEl.innerText = Math.floor(energy);
            autoBalanceEl.innerText = autoBalance.toFixed(2);
            usdtValueEl.innerText = '$' + (score / 1000000).toFixed(4);
            
            let percent = (autoBalance / MAX_STORAGE) * 100;
            storageBar.style.width = percent + '%';
            
            // Determinar Rango
            let rank = "NOVATO";
            if(score > 5000) rank = "CYBER PUNK";
            if(score > 25000) rank = "MAESTRO";
            if(score > 100000) rank = "BALLENA";
            document.getElementById('rank-name').innerText = rank;
        }

        // Clicker Event
        coinBtn.addEventListener('click', (e) => {
            if (energy < 1) return;
            
            // Vibración
            if(navigator.vibrate) navigator.vibrate(10);
            
            // Lógica
            score++;
            energy--;
            updateUI();

            // Animación del número flotante
            const rect = coinBtn.getBoundingClientRect();
            const floatEl = document.createElement('div');
            floatEl.className = 'floating-text';
            floatEl.innerText = '+1';
            
            // Posición aleatoria cerca del toque
            const randomX = (Math.random() - 0.5) * 40;
            floatEl.style.left = (e.clientX - rect.left + randomX) + 'px';
            floatEl.style.top = (e.clientY - rect.top) + 'px';
            
            coinBtn.appendChild(floatEl);
            setTimeout(() => floatEl.remove(), 800);

            // Animación botón
            coinBtn.style.transform = 'scale(0.95)';
            setTimeout(() => coinBtn.style.transform = 'scale(1)', 100);
        });

        // Loop Principal (Cada segundo)
        setInterval(() => {
            // Regenerar Energía
            if (energy < 1000) energy += 1;
            
            // Minería Automática (Auto Collector)
            if (autoBalance < MAX_STORAGE) {
                autoBalance += 0.05;
                if(autoBalance > MAX_STORAGE) autoBalance = MAX_STORAGE;
            }

            // Minería por Máquinas
            if(miningRate > 0) {
                score += miningRate;
            }

            updateUI();
        }, 1000);

        function claimAuto() {
            if(autoBalance < 1) return;
            score += autoBalance;
            autoBalance = 0;
            updateUI();
            tg.showAlert("¡Has recolectado tus SATS minados!");
        }

        function switchTab(tabName, btn) {
            // Ocultar todas las vistas
            ['home', 'mine', 'wallet', 'friends'].forEach(v => {
                document.getElementById('view-' + v).classList.add('hidden');
            });
            // Mostrar la seleccionada
            document.getElementById('view-' + tabName).classList.remove('hidden');

            // Actualizar botones
            document.querySelectorAll('.nav-item').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }

        function renderMachines() {
            machinesList.innerHTML = '';
            machines.forEach(m => {
                const div = document.createElement('div');
                div.className = 'upgrade-item';
                div.innerHTML = `
                    <div class="flex items-center gap-2">
                        <div style="background:rgba(255,255,255,0.1); padding:10px; border-radius:10px; font-size:20px;">⚡</div>
                        <div>
                            <div style="font-weight:bold; font-size:14px;">${m.name}</div>
                            <div style="font-size:10px; color:#4ade80;">+${m.rate} Sat/s</div>
                        </div>
                    </div>
                    <button class="btn" style="width:auto; padding: 8px 15px; font-size:10px;" onclick="buyMachine(${m.id})">
                        ${m.price} SATS
                    </button>
                `;
                machinesList.appendChild(div);
            });
        }

        function buyMachine(id) {
            const machine = machines.find(m => m.id === id);
            if(score >= machine.price) {
                score -= machine.price;
                miningRate += machine.rate;
                updateUI();
                tg.showAlert(`¡Compraste ${machine.name}! Tu poder de minado aumentó.`);
            } else {
                tg.showAlert("No tienes suficientes Satoshis.");
            }
        }
        
        function copyLink() {
            friends++;
            friendsCountEl.innerText = friends;
            tg.showAlert("Link copiado (Simulación). ¡Un amigo se unió!");
        }

        // Inicialización
        renderMachines();
        updateUI();

    </script>
</body>
</html>
